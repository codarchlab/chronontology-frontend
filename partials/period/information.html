<div ng-controller="PeriodController">

<script type="text/ng-template" id="/explicitRelations">
	<span ng-if="period.relations[relation]">
		<dt>{{ "relation_"+relation | transl8 }}</dt>
		<dd ng-repeat="document in relatedDocuments[relation]" ng-include src="'/periodLink'"></dd>
		<br>
	</span>
</script>

<script type="text/ng-template" id="/derivedRelations">
	<span ng-if="document.derived.relations[relation]">
		<dt>{{ "relation_"+relation | transl8 }}</dt>
		<dd ng-repeat="document in relatedDocuments.derived[relation]" ng-include src="'/periodLink'"></dd>
		<br>
	</span>
</script>

<script type="text/ng-template" id="/periodLink">
	<a ng-href="/period/{{document.resource.id}}">{{ document.resource.names | prefName }}</a>
	({{ document.resource.types.join(", ") }})
	{{ document.resource.provenance }}
</script>

<script type="text/ng-template" id="/intervalBoundary">
	<span ng-if="timespan[boundary]">
		{{ "temporal_"+boundary | transl8 }}
		<span ng-if="timespan[boundary].at">
			{{ timespan[boundary].at }}
			<span ng-if="timespan[boundary].atPrecision">
				({{ timespan[boundary].atPrecision }})
			</span>
		</span>
		<span ng-if="timespan[boundary].notBefore">{{ "temporal_notBefore" | transl8 }} {{ timespan[boundary].notBefore }}</span>
		<span ng-if="timespan[boundary].notAfter">{{ "temporal_notAfter" | transl8 }} {{ timespan[boundary].notAfter }}</span>
		<br>
	</span>
</script>


<dl class="dl-horizontal">

	<h4>{{ "ui_periodInfo" | transl8 }}</h4>

    <dt>{{ "period_names" | transl8 }}</dt>
    <span ng-repeat="(language, names) in period.names">
        <dd ng-repeat="name in names">
            {{ name }} <i>({{language}})</i>
        </dd>
    </span>
    <br>

    <dt>{{ "period_type" | transl8 }}</dt>
    <dd ng-repeat="type in period.types">{{ type }}</dd>
    <br>

    <dt>{{ "period_provenance" | transl8 }}</dt>
    <dd>
        <a ng-href="/thesaurus/{{ period.provenance }}">{{ period.provenance }}</a>
        <span ng-if="period.externalId">(originale ID: {{ period.externalId }})</span>
    </dd>
    <br>

    <span ng-if="period.definition">
        <dt>{{ "period_definition" | transl8 }}</dt>
        <dd class="preserve-linebreaks">{{ period.definition }}</dd>
        <br>
    </span>

    <span ng-if="period.description">
        <dt>{{ "period_description" | transl8 }}</dt>
        <dd class="preserve-linebreaks">{{ period.description }}</dd>
        <br>
    </span>

    <span ng-if="period.tags">
        <dt>{{ "period_tags" | transl8 }}</dt>
        <dd>{{ period.tags.join(", ") }}</dd>
        <br>
    </span>

    <span ng-if="period.note">
        <dt>{{ "period_note" | transl8 }}</dt>
        <dd class="preserve-linebreaks">{{ period.note }}</dd>
        <br>
    </span>

    <span ng-if="period.hasTimespan">
        <dt>{{ "period_temporalExtent" | transl8 }}</dt>
        <span ng-if="period.ongoing">
            <dd>{{ "period_ongoing" | transl8 }}</dd>
            <br>
        </span>
        <dd ng-repeat="timespan in period.hasTimespan">
            {{ timespan.timeOriginal }}
            <br>
            <span ng-repeat="boundary in ['begin', 'end']" ng-include src="'/intervalBoundary'"></span>
            <span ng-if="timespan.calendar">{{ "temporal_calendar" | transl8 }} {{ timespan.calendar }}<br></span>
            <span ng-if="timespan.sourceOriginal">{{ "ui_source" | transl8 }} {{ timespan.sourceOriginal }}<br></span>
            <span ng-if="timespan.sourceURL"><a ng-href="{{timespan.sourceURL}}">{{timespan.sourceURL}}</a><br></span>
        </dd>
        <br>
    </span>

    <span ng-repeat="gazetteerRelation in gazetteerRelations">
        <span ng-if="period[gazetteerRelation]">
            <dt>{{ "relation_"+gazetteerRelation | transl8 }}</dt>
            <dd ng-repeat="regionUri in period[gazetteerRelation]">
				<span ng-if="document.related[regionUri]">
					<a ng-href="regionUri" target="_blank">
						{{document.related[regionUri].prefName.title}} <span class="glyphicon glyphicon-new-window"></span>
					</a>
				</span>
				<span ng-if="!document.related[regionUri]">
					<a ng-href="{{regionUri}}" target="_blank">
						{{regionUri}} <span class="glyphicon glyphicon-new-window"></span>
					</a>
				</span>
            </dd>
            <br>
        </span>
    </span>
</dl>

<dl class="dl-horizontal">

    <h5>{{ "ui_relations" | transl8 }}</h5>

	<span ng-repeat="relation in internalRelations" ng-include src="'/explicitRelations'"></span>

	<span ng-repeat="relation in allenRelations" ng-include src="'/explicitRelations'"></span>

    <h4>{{ "ui_derivedInfo" | transl8 }}</h4>

    <span ng-repeat="gazetteerRelation in gazetteerRelations">
        <span ng-if="document.derived[gazetteerRelation]">
            <dt>{{ "relation_"+gazetteerRelation | transl8 }}</dt>
            <dd ng-repeat="regionUri in document.derived[gazetteerRelation]">
				<span ng-if="document.related[regionUri]">
					<a ng-href="regionUri" target="_blank">
						{{document.related[regionUri].prefName.title}} <span class="glyphicon glyphicon-new-window"></span>
					</a>
				</span>
				<span ng-if="!document.related[regionUri]">
					<a ng-href="{{regionUri}}" target="_blank">
						{{regionUri}} <span class="glyphicon glyphicon-new-window"></span>
					</a>
				</span>
            </dd>
            <br>
        </span>
    </span>

<span ng-if="document.derived.relations">

    <h5>{{ "ui_relations" | transl8 }}</h5>

	<span ng-repeat="relation in internalRelations" ng-include src="'/derivedRelations'"></span>

	<span ng-repeat="relation in allenRelations" ng-include src="'/derivedRelations'"></span>

</span>

</dl>

<span ng-if="authService.getUser() != undefined">

	<h4>{{ "ui_metadata" | transl8 }}</h4>

	<dl class="dl-horizontal">

		<dt>{{ "ui_created" | transl8 }}</dt>
		<dd>
			{{document.created.date | date:'medium' }}
			({{document.created.user}})
		</dd>
		<br>

		<dt>{{ "ui_modified" | transl8 }}</dt>
		<dd ng-repeat="m in document.modified">
			{{ m.date | date:'medium' }}
			({{ m.user }})
		</dd>
		<br>

	</dl>

</span>

</div>
