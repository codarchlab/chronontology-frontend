<script type="text/ng-template" id="/explicitRelations">
	<span ng-if="$ctrl.period.relations[relation]">
		<dt>{{ "relation_"+relation | transl8 }}</dt>
		<dd ng-repeat="document in $ctrl.relatedDocuments[relation]" ng-include src="'/periodLink'"></dd>
		<br>
	</span>
</script>

<script type="text/ng-template" id="/derivedRelations">
	<span ng-if="$ctrl.document.derived.relations[relation]">
		<dt>{{ "relation_"+relation | transl8 }}</dt>
		<dd ng-repeat="document in $ctrl.relatedDocuments.derived[relation]" ng-include src="'/periodLink'"></dd>
		<br>
	</span>
</script>

<script type="text/ng-template" id="/periodLink">
	<a ng-href="/period/{{document.resource.id}}">{{ document.resource.names | prefName }}</a>
	({{ document.resource.types.join(", ") }})
	{{ document.resource.provenance }}
</script>

<script type="text/ng-template" id="/intervalBoundary">
	<span ng-if="timespan[boundary]">
		{{ "temporal_"+boundary | transl8 }}
		<span ng-if="timespan[boundary].at">
			{{ timespan[boundary].at }}
			<span ng-if="timespan[boundary].atPrecision">
				({{ timespan[boundary].atPrecision }})
			</span>
		</span>
		<span ng-if="timespan[boundary].notBefore">{{ "temporal_notBefore" | transl8 }} {{ timespan[boundary].notBefore }}</span>
		<span ng-if="timespan[boundary].notAfter">{{ "temporal_notAfter" | transl8 }} {{ timespan[boundary].notAfter }}</span>
		<br>
	</span>
</script>


<dl class="dl-horizontal">

	<h4>{{ "ui_periodInfo" | transl8 }}</h4>

    <dt>{{ "period_names" | transl8 }}</dt>
    <span ng-repeat="language in $ctrl.period.names">
        <dd ng-repeat="name in language.content">
            {{ name }} <i>({{language.lang}})</i>
        </dd>
    </span>
    <br>

    <dt>{{ "period_type" | transl8 }}</dt>
    <dd ng-repeat="type in $ctrl.period.types">{{ type }}</dd>
    <br>

    <dt>{{ "period_provenance" | transl8 }}</dt>
    <dd>
        <a ng-href="/thesaurus/{{ $ctrl.period.provenance }}">{{ $ctrl.period.provenance }}</a>
        <span ng-if="$ctrl.period.externalId">(originale ID: {{ $ctrl.period.externalId }})</span>
    </dd>
    <br>

    <span ng-if="$ctrl.period.definition">
        <dt>{{ "period_definition" | transl8 }}</dt>
        <dd class="preserve-linebreaks">{{ $ctrl.period.definition }}</dd>
        <br>
    </span>

    <span ng-if="$ctrl.period.description">
        <dt>{{ "period_description" | transl8 }}</dt>
        <dd class="preserve-linebreaks">{{ $ctrl.period.description }}</dd>
        <br>
    </span>

    <span ng-if="$ctrl.period.tags">
        <dt>{{ "period_tags" | transl8 }}</dt>
        <dd>{{ $ctrl.period.tags.join(", ") }}</dd>
        <br>
    </span>

    <span ng-if="$ctrl.period.note">
        <dt>{{ "period_note" | transl8 }}</dt>
        <dd class="preserve-linebreaks">{{ $ctrl.period.note }}</dd>
        <br>
    </span>

    <span ng-if="$ctrl.period.hasTimespan">
        <dt>{{ "period_temporalExtent" | transl8 }}</dt>
        <span ng-if="$ctrl.period.ongoing">
            <dd>{{ "period_ongoing" | transl8 }}</dd>
            <br>
        </span>
        <dd ng-repeat="timespan in $ctrl.period.hasTimespan">
            {{ timespan.timeOriginal }}
            <br>
            <span ng-repeat="boundary in ['begin', 'end']" ng-include src="'/intervalBoundary'"></span>
            <span ng-if="timespan.calendar">{{ "temporal_calendar" | transl8 }} {{ timespan.calendar }}<br></span>
            <span ng-if="timespan.sourceOriginal">{{ "ui_source" | transl8 }} {{ timespan.sourceOriginal }}<br></span>
            <span ng-if="timespan.sourceURL"><a ng-href="{{timespan.sourceURL}}">{{timespan.sourceURL}}</a><br></span>
        </dd>
        <br>
    </span>

    <span ng-repeat="gazetteerRelation in $ctrl.gazetteerRelations">
        <span ng-if="$ctrl.period[gazetteerRelation]">
            <dt>{{ "relation_"+gazetteerRelation | transl8 }}</dt>
            <dd ng-repeat="regionUri in $ctrl.period[gazetteerRelation]">
				<span ng-if="$ctrl.document.related[regionUri]">
					<a ng-href="regionUri" target="_blank">
						{{$ctrl.document.related[regionUri].prefName.title}} <span class="glyphicon glyphicon-new-window"></span>
					</a>
				</span>
				<span ng-if="!$ctrl.document.related[regionUri]">
					<a ng-href="regionUri" target="_blank">
						{{regionUri}} <span class="glyphicon glyphicon-new-window"></span>
					</a>
				</span>
            </dd>
            <br>
        </span>
    </span>
</dl>

<dl class="dl-horizontal">

    <h5>{{ "ui_relations" | transl8 }}</h5>

	<span ng-repeat="relation in $ctrl.internalRelations" ng-include src="'/explicitRelations'"></span>

	<span ng-repeat="relation in $ctrl.allenRelations" ng-include src="'/explicitRelations'"></span>

    <h4>{{ "ui_derivedInfo" | transl8 }}</h4>

    <span ng-repeat="gazetteerRelation in $ctrl.gazetteerRelations">
        <span ng-if="$ctrl.document.derived[gazetteerRelation]">
            <dt>{{ "relation_"+gazetteerRelation | transl8 }}</dt>
            <dd ng-repeat="regionUri in $ctrl.document.derived[gazetteerRelation]">
				<span ng-if="$ctrl.document.related[regionUri]">
					<a ng-href="regionUri" target="_blank">
						{{$ctrl.document.related[regionUri].prefName.title}} <span class="glyphicon glyphicon-new-window"></span>
					</a>
				</span>
				<span ng-if="!$ctrl.document.related[regionUri]">
					<a ng-href="regionUri" target="_blank">
						{{regionUri}} <span class="glyphicon glyphicon-new-window"></span>
					</a>
				</span>
            </dd>
            <br>
        </span>
    </span>

<span ng-if="$ctrl.document.derived.relations">

    <h5>{{ "ui_relations" | transl8 }}</h5>

	<span ng-repeat="relation in $ctrl.internalRelations" ng-include src="'/derivedRelations'"></span>

	<span ng-repeat="relation in $ctrl.allenRelations" ng-include src="'/derivedRelations'"></span>

</span>

</dl>

<h4>{{ "ui_metadata" | transl8 }}</h4>

<dl class="dl-horizontal">

    <dt>{{ "ui_created" | transl8 }}</dt>
    <dd>
        {{$ctrl.document.created.date | isoDate | date:'medium' }}
        ({{$ctrl.document.created.user}})
    </dd>
    <br>

    <dt>{{ "ui_modified" | transl8 }}</dt>
    <dd ng-repeat="m in $ctrl.document.modified">
        {{ m.date | isoDate | date:'medium' }}
        ({{ m.user }})
    </dd>
    <br>

</dl>
